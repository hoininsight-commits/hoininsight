id: topic_gate_output_v1
type: object
required:
  - schema_version
  - as_of_date
  - topic_id
  - title
  - question
  - why_people_confused
  - key_reasons
  - numbers
  - risk_one
  - confidence
  - handoff_to_structural
  - handoff_reason
  - source_candidates
properties:
  schema_version:
    type: string
    enum: ["topic_gate_output_v1"]
  as_of_date:
    type: string
    description: "YYYY-MM-DD"
  topic_id:
    type: string
  title:
    type: string
    description: "짧은 문장형 제목"
  question:
    type: string
    description: "질문형 토픽"
  why_people_confused:
    type: string
  key_reasons:
    type: array
    minItems: 2
    maxItems: 3
    items:
      type: string
  numbers:
    type: array
    description: "0~3개. Gate는 Z-score/L레벨 금지"
    maxItems: 3
    items:
      type: object
      required: [label, value, unit]
      properties:
        label: { type: string }
        value:
          oneOf:
            - { type: number }
            - { type: string }
        unit: { type: string }
  risk_one:
    type: string
  confidence:
    type: string
    enum: ["LOW", "MEDIUM", "HIGH"]
  handoff_to_structural:
    type: boolean
    description: "승격이 아니라 handoff 플래그만"
  handoff_reason:
    type: string
  source_candidates:
    type: array
    minItems: 1
    items:
      type: string

# NOTE (GUARDRAIL):
# - Gate Output은 Structural Insight Script 템플릿을 재사용하지 않는다.
# - level/z_score/anomaly_logic/theme_leaders(대장주) 금지.
